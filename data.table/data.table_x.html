<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Data wrangling with tidyverse</title>
    <meta charset="utf-8" />
    <meta name="author" content="AECN 396/896-002" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <link href="libs/animate.css/animate.xaringan.css" rel="stylesheet" />
    <link href="libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <link href="libs/panelset/panelset.css" rel="stylesheet" />
    <script src="libs/panelset/panelset.js"></script>
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"Copy Code","success":"Copied!","error":"Press Ctrl+C to Copy"})</script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Data wrangling with <code>tidyverse</code>
### AECN 396/896-002

---











&lt;style type="text/css"&gt;
.important {
  background-color: lightpink;
  border: 2px solid blue;
  font-weight: bold;
} 

.remark-code {
  display: block;
  overflow-x: auto;
  padding: .5em;
  background: #ffe7e7;
} 

.hljs-github .hljs {
  background: #f2f2fd;
}

.remark-inline-code {
  padding-top: 0px;
  padding-bottom: 0px;
  background-color: #e6e6e6;
}

.r.hljs.remark-code.remark-inline-code{
  font-size: 0.9em
}

.left-full {
  width: 80%;
  height: 92%;
  float: left;
}

.left-code {
  width: 38%;
  height: 92%;
  float: left;
}

.right-plot {
  width: 60%;
  float: right;
  padding-left: 1%;
}

.left5 {
  width: 49%;
  height: 92%;
  float: left;
}

.right5 {
  width: 49%;
  float: right;
  padding-left: 1%;
}

.left4 {
  width: 38%;
  height: 92%;
  float: left;
}

.right6 {
  width: 60%;
  float: right;
  padding-left: 1%;
}

ul li{
  margin: 7px;
}

ul, li{
  margin-left: 15px; 
  padding-left: 0px; 
}

ol li{
  margin: 7px;
}

ol, li{
  margin-left: 15px; 
  padding-left: 0px; 
}

&lt;/style&gt;

&lt;style type="text/css"&gt;
.content-box { 
    box-sizing: border-box;
    background-color: #e2e2e2;
}
.content-box-blue,
.content-box-gray,
.content-box-grey,
.content-box-army,
.content-box-green,
.content-box-purple,
.content-box-red,
.content-box-yellow {
  box-sizing: border-box;
  border-radius: 15px;
  margin: 0 0 15px;
  overflow: hidden;
  padding: 0px 20px 0px 20px;
  width: 100%;
}
.content-box-blue { background-color: #F0F8FF; }
.content-box-gray { background-color: #e2e2e2; }
.content-box-grey { background-color: #F5F5F5; }
.content-box-army { background-color: #737a36; }
.content-box-green { background-color: #d9edc2; }
.content-box-purple { background-color: #e2e2f9; }
.content-box-red { background-color: #ffcccc; }
.content-box-yellow { background-color: #fef5c4; }
.content-box-blue .remark-inline-code,
.content-box-blue .remark-inline-code,
.content-box-gray .remark-inline-code,
.content-box-grey .remark-inline-code,
.content-box-army .remark-inline-code,
.content-box-green .remark-inline-code,
.content-box-purple .remark-inline-code,
.content-box-red .remark-inline-code,
.content-box-yellow .remark-inline-code { 
  background: none;
}

.full-width {
    display: flex;
    width: 100%;
    flex: 1 1 auto;
}
&lt;/style&gt;


&lt;style type="text/css"&gt;
blockquote, .blockquote {
  display: block;
  margin-top: 0.1em;
  margin-bottom: 0.2em;
  margin-left: 5px;
  margin-right: 5px;
  border-left: solid 10px #0148A4;
  border-top: solid 2px #0148A4;
  border-bottom: solid 2px #0148A4;
  border-right: solid 2px #0148A4;
  box-shadow: 0 0 6px rgba(0,0,0,0.5);
  /* background-color: #e64626; */
  color: #e64626;
  padding: 0.5em;
  -moz-border-radius: 5px;
  -webkit-border-radius: 5px;
}

.blockquote p {
  margin-top: 0px;
  margin-bottom: 5px;
}
.blockquote &gt; h1:first-of-type {
  margin-top: 0px;
  margin-bottom: 5px;
}
.blockquote &gt; h2:first-of-type {
  margin-top: 0px;
  margin-bottom: 5px;
}
.blockquote &gt; h3:first-of-type {
  margin-top: 0px;
  margin-bottom: 5px;
}
.blockquote &gt; h4:first-of-type {
  margin-top: 0px;
  margin-bottom: 5px;
}

.text-shadow {
  text-shadow: 0 0 4px #424242;
}
&lt;/style&gt;

&lt;style type="text/css"&gt;
/******************
 * Slide scrolling
 * (non-functional)
 * not sure if it is a good idea anyway
slides &gt; slide {
  overflow: scroll;
 padding: 5px 40px;
}
.scrollable-slide .remark-slide {
  height: 400px;
  overflow: scroll !important;
}
 ******************/

.scroll-box-8 {
  height:8em;
  overflow-y: scroll;
}
.scroll-box-10 {
  height:10em;
  overflow-y: scroll;
}
.scroll-box-12 {
  height:12em;
  overflow-y: scroll;
}
.scroll-box-14 {
  height:14em;
  overflow-y: scroll;
}
.scroll-box-16 {
  height:16em;
  overflow-y: scroll;
}
.scroll-box-18 {
  height:18em;
  overflow-y: scroll;
}
.scroll-box-20 {
  height:20em;
  overflow-y: scroll;
}
.scroll-box-24 {
  height:24em;
  overflow-y: scroll;
}
.scroll-box-30 {
  height:30em;
  overflow-y: scroll;
}
.scroll-output {
  height: 90%;
  overflow-y: scroll;
}

 
&lt;/style&gt;



# Table of contents

2. [`data.frame` and `tibble`](#df_tbl)
3. [Data manipulation with `dplyr`: the Basics](#dplyr)
4. [Grouped operations](#grouped)
5. [Extensions](#extensions)
6. [Reshaping data](#reshaping)
7. [Merging datasets](#merging)

---

# Learning objectives

The objectives of this chapter is to learn how to use the `data.table` package to 

+ manipulate data 
+ reshape a dataset
+ merge multiple datasets 

---

#  `data.table` package

.panelset[ 

.panel[.panel-name[What is it?]

The `data.table` package is a popular alternative to `dplyr` that is **much faster** than `dplyr` for most data operations.

See [here](https://github.com/Rdatatable/data.table/wiki/Benchmarks-%3A-Grouping) for the speed comparison of `dplyr` and `data.table`.

Install the package if you have not.


```r
install.packages("data.table")
```


```r
library(data.table)
```

  ]

.panel[.panel-name[Preparation]


We use `HousePrices` dataset from the `AER` package.


```r
#--- load the AER package ---#
library(AER)

#--- load the HousePrices data ---#
data(HousePrices) 

#--- convert to tibble ---#
hp_tbl &lt;- tibble(HousePrices)
```

  ]

.panel[.panel-name[conversion]

The `data.table` offers a different class of two-dimensional data called `data.table`. 

Unlike `dplyr`, `data.table` functionalities for data wrangling can only be applied to a `data.table` object.

You can use `data.table()` to convert a `data.frame` (or `tibble`) into a `data.table`


```r
hp_dt &lt;- data.table(hp_tbl)  
```

Check the class:


```r
class(hp_dt)  
```

```
## [1] "data.table" "data.frame"
```

  ] 

  &lt;!-- panel ends here --&gt;

.panel[.panel-name[display]

.left5[

```r
hp_tbl
```

```
## # A tibble: 546 x 12
##    price lotsize bedrooms bathrooms stories driveway
##    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;   
##  1 42000    5850        3         1       2 yes     
##  2 38500    4000        2         1       1 yes     
##  3 49500    3060        3         1       1 yes     
##  4 60500    6650        3         1       2 yes     
##  5 61000    6360        2         1       1 yes     
##  6 66000    4160        3         1       1 yes     
##  7 66000    3880        3         2       2 yes     
##  8 69000    4160        3         1       3 yes     
##  9 83800    4800        3         1       1 yes     
## 10 88500    5500        3         2       4 yes     
## # â€¦ with 536 more rows, and 6 more variables:
## #   recreation &lt;fct&gt;, fullbase &lt;fct&gt;, gasheat &lt;fct&gt;,
## #   aircon &lt;fct&gt;, garage &lt;dbl&gt;, prefer &lt;fct&gt;
```

&lt;br&gt;

.red[Note]: unlike `tibble`, all the columns are printed for the first and last 5 rows when you evaluate a `data.table` object. 
]

.right5[

.scroll-box-30[

```r
hp_dt
```

```
##       price lotsize bedrooms bathrooms stories
##   1:  42000    5850        3         1       2
##   2:  38500    4000        2         1       1
##   3:  49500    3060        3         1       1
##   4:  60500    6650        3         1       2
##   5:  61000    6360        2         1       1
##  ---                                          
## 542:  91500    4800        3         2       4
## 543:  94000    6000        3         2       4
## 544: 103000    6000        3         2       4
## 545: 105000    6000        3         2       2
## 546: 105000    6000        3         1       2
##      driveway recreation fullbase gasheat aircon
##   1:      yes         no      yes      no     no
##   2:      yes         no       no      no     no
##   3:      yes         no       no      no     no
##   4:      yes        yes       no      no     no
##   5:      yes         no       no      no     no
##  ---                                            
## 542:      yes        yes       no      no    yes
## 543:      yes         no       no      no    yes
## 544:      yes        yes       no      no    yes
## 545:      yes        yes       no      no    yes
## 546:      yes         no       no      no    yes
##      garage prefer
##   1:      1     no
##   2:      0     no
##   3:      0     no
##   4:      0     no
##   5:      0     no
##  ---              
## 542:      0     no
## 543:      0     no
## 544:      1     no
## 545:      1     no
## 546:      1     no
```
 ] 

]


  ] 

  &lt;!-- panel ends here --&gt;
]


---

# Accessing parts of the data 

.panelset[ 

.panel[.panel-name[Numerical index]

The ways you access parts of `tibble` and `data.table` are very different!

Numerical indexing does not even work!!

.left5[

`data.frame`


```r
hp_tbl[2:8, c(3,5)]
```

```
## # A tibble: 7 x 2
##   bedrooms stories
##      &lt;dbl&gt;   &lt;dbl&gt;
## 1        2       1
## 2        3       1
## 3        3       2
## 4        2       1
## 5        3       1
## 6        3       2
## 7        3       3
```
]

.right5[

`tibble`


```r
hp_dt[2:8, c(3,5)]
```

```
##    bedrooms stories
## 1:        2       1
## 2:        3       1
## 3:        3       2
## 4:        2       1
## 5:        3       1
## 6:        3       2
## 7:        3       3
```
]

  ]

]

&lt;!-- panel set ends here --&gt;

---

# Before we start

For illustrations, we will use `flights_mini` that we create below:


```r
library(nycflights13)

(
flights_dt &lt;- distinct(flights,month,day,.keep_all=TRUE) %&gt;% 
  filter(day %in% c(1,2)) %&gt;% 
  arrange(month) %&gt;% 
  data.table()
)
```

.scroll-box-20[

```
##     year month day dep_time sched_dep_time dep_delay
##  1: 2013     1   1      517            515         2
##  2: 2013     1   2       42           2359        43
##  3: 2013     2   1      456            500        -4
##  4: 2013     2   2        3           2359         4
##  5: 2013     3   1        4           2159       125
##  6: 2013     3   2       43           2355        48
##  7: 2013     4   1      454            500        -6
##  8: 2013     4   2        9           2355        14
##  9: 2013     5   1        9           1655       434
## 10: 2013     5   2        3           1905       298
## 11: 2013     6   1        2           2359         3
## 12: 2013     6   2       14           2359        15
## 13: 2013     7   1        1           2029       212
## 14: 2013     7   2       12           2245        87
## 15: 2013     8   1       12           2130       162
## 16: 2013     8   2        6           2359         7
## 17: 2013     9   1        9           2359        10
## 18: 2013     9   2        8           2255        73
## 19: 2013    10   1      447            500       -13
## 20: 2013    10   2      449            500       -11
## 21: 2013    11   1        5           2359         6
## 22: 2013    11   2      453            500        -7
## 23: 2013    12   1       13           2359        14
## 24: 2013    12   2       12           2250        82
##     year month day dep_time sched_dep_time dep_delay
##     arr_time sched_arr_time arr_delay carrier flight
##  1:      830            819        11      UA   1545
##  2:      518            442        36      B6    707
##  3:      652            648         4      US   1117
##  4:      513            444        29      B6    739
##  5:      318             56       142      B6     11
##  6:      605            440        85      B6    739
##  7:      636            640        -4      US   1843
##  8:      346            345         1      B6    739
##  9:      308           2020       408      VX    413
## 10:      241           2224       257      B6    111
## 11:      341            350        -9      B6    739
## 12:      339            341        -2      B6    727
## 13:      236           2359       157      B6    915
## 14:      117              4        73      B6    108
## 15:      257             14       163      B6   1371
## 16:      420            340        40      B6    839
## 17:      343            340         3      B6    839
## 18:      126             19        67      B6   2002
## 19:      614            648       -34      US   1877
## 20:      620            648       -28      US   1877
## 21:      352            345         7      B6    745
## 22:      644            651        -7      US   1895
## 23:      446            445         1      B6    745
## 24:      103           2356        67      B6   1816
##     arr_time sched_arr_time arr_delay carrier flight
##     tailnum origin dest air_time distance hour
##  1:  N14228    EWR  IAH      227     1400    5
##  2:  N580JB    JFK  SJU      189     1598   23
##  3:  N197UW    EWR  CLT       98      529    5
##  4:  N569JB    JFK  PSE      206     1617   23
##  5:  N706JB    JFK  FLL      166     1069   21
##  6:  N623JB    JFK  PSE      219     1617   23
##  7:  N566UW    EWR  CLT       84      529    5
##  8:  N519JB    JFK  PSE      197     1617   23
##  9:  N628VA    JFK  LAX      341     2475   16
## 10:  N603JB    JFK  FLL      135     1069   19
## 11:  N618JB    JFK  PSE      200     1617   23
## 12:  N558JB    JFK  BQN      187     1576   23
## 13:  N653JB    JFK  SFO      315     2586   20
## 14:  N318JB    JFK  PWM       45      273   22
## 15:  N618JB    LGA  FLL      149     1076   21
## 16:  N608JB    JFK  BQN      193     1576   23
## 17:  N663JB    JFK  BQN      196     1576   23
## 18:  N231JB    JFK  BUF       55      301   22
## 19:  N538UW    EWR  CLT       69      529    5
## 20:  N193UW    EWR  CLT       73      529    5
## 21:  N568JB    JFK  PSE      205     1617   23
## 22:  N190UW    EWR  CLT       97      529    5
## 23:  N715JB    JFK  PSE      195     1617   23
## 24:  N316JB    JFK  SYR       35      209   22
##     tailnum origin dest air_time distance hour
##     minute           time_hour
##  1:     15 2013-01-01 05:00:00
##  2:     59 2013-01-02 23:00:00
##  3:      0 2013-02-01 05:00:00
##  4:     59 2013-02-02 23:00:00
##  5:     59 2013-03-01 21:00:00
##  6:     55 2013-03-02 23:00:00
##  7:      0 2013-04-01 05:00:00
##  8:     55 2013-04-02 23:00:00
##  9:     55 2013-05-01 16:00:00
## 10:      5 2013-05-02 19:00:00
## 11:     59 2013-06-01 23:00:00
## 12:     59 2013-06-02 23:00:00
## 13:     29 2013-07-01 20:00:00
## 14:     45 2013-07-02 22:00:00
## 15:     30 2013-08-01 21:00:00
## 16:     59 2013-08-02 23:00:00
## 17:     59 2013-09-01 23:00:00
## 18:     55 2013-09-02 22:00:00
## 19:      0 2013-10-01 05:00:00
## 20:      0 2013-10-02 05:00:00
## 21:     59 2013-11-01 23:00:00
## 22:      0 2013-11-02 05:00:00
## 23:     59 2013-12-01 23:00:00
## 24:     50 2013-12-02 22:00:00
##     minute           time_hour
```
]



---

# Filter 
 

.panelset[ 
 
.panel[.panel-name[]

Instead of explicit verbs, you do everything inside `[]`.


```r
data[condition,]  
```

where `data` is a `data.table` object.
  ]
 
 &lt;!-- panel ends here --&gt;
 
.panel[.panel-name[]


```r
flights_dt[month &lt;= 4,]
```

.scroll-box-24[

```
##    year month day dep_time sched_dep_time dep_delay
## 1: 2013     1   1      517            515         2
## 2: 2013     1   2       42           2359        43
## 3: 2013     2   1      456            500        -4
## 4: 2013     2   2        3           2359         4
## 5: 2013     3   1        4           2159       125
## 6: 2013     3   2       43           2355        48
## 7: 2013     4   1      454            500        -6
## 8: 2013     4   2        9           2355        14
##    arr_time sched_arr_time arr_delay carrier flight
## 1:      830            819        11      UA   1545
## 2:      518            442        36      B6    707
## 3:      652            648         4      US   1117
## 4:      513            444        29      B6    739
## 5:      318             56       142      B6     11
## 6:      605            440        85      B6    739
## 7:      636            640        -4      US   1843
## 8:      346            345         1      B6    739
##    tailnum origin dest air_time distance hour minute
## 1:  N14228    EWR  IAH      227     1400    5     15
## 2:  N580JB    JFK  SJU      189     1598   23     59
## 3:  N197UW    EWR  CLT       98      529    5      0
## 4:  N569JB    JFK  PSE      206     1617   23     59
## 5:  N706JB    JFK  FLL      166     1069   21     59
## 6:  N623JB    JFK  PSE      219     1617   23     55
## 7:  N566UW    EWR  CLT       84      529    5      0
## 8:  N519JB    JFK  PSE      197     1617   23     55
##              time_hour
## 1: 2013-01-01 05:00:00
## 2: 2013-01-02 23:00:00
## 3: 2013-02-01 05:00:00
## 4: 2013-02-02 23:00:00
## 5: 2013-03-01 21:00:00
## 6: 2013-03-02 23:00:00
## 7: 2013-04-01 05:00:00
## 8: 2013-04-02 23:00:00
```
]

 ]

 &lt;!-- panel ends here --&gt;

.panel[.panel-name[]


```r
flights_dt[month &lt;= 4 | month &gt;= 11,]
```

.scroll-box-24[

```
##    year month day dep_time sched_dep_time dep_delay
## 1: 2013     1   1      517            515         2
## 2: 2013     1   2       42           2359        43
## 3: 2013     2   1      456            500        -4
## 4: 2013     2   2        3           2359         4
## 5: 2013     3   1        4           2159       125
## 6: 2013     3   2       43           2355        48
## 7: 2013     4   1      454            500        -6
## 8: 2013     4   2        9           2355        14
##    arr_time sched_arr_time arr_delay carrier flight
## 1:      830            819        11      UA   1545
## 2:      518            442        36      B6    707
## 3:      652            648         4      US   1117
## 4:      513            444        29      B6    739
## 5:      318             56       142      B6     11
## 6:      605            440        85      B6    739
## 7:      636            640        -4      US   1843
## 8:      346            345         1      B6    739
##    tailnum origin dest air_time distance hour minute
## 1:  N14228    EWR  IAH      227     1400    5     15
## 2:  N580JB    JFK  SJU      189     1598   23     59
## 3:  N197UW    EWR  CLT       98      529    5      0
## 4:  N569JB    JFK  PSE      206     1617   23     59
## 5:  N706JB    JFK  FLL      166     1069   21     59
## 6:  N623JB    JFK  PSE      219     1617   23     55
## 7:  N566UW    EWR  CLT       84      529    5      0
## 8:  N519JB    JFK  PSE      197     1617   23     55
##              time_hour
## 1: 2013-01-01 05:00:00
## 2: 2013-01-02 23:00:00
## 3: 2013-02-01 05:00:00
## 4: 2013-02-02 23:00:00
## 5: 2013-03-01 21:00:00
## 6: 2013-03-02 23:00:00
## 7: 2013-04-01 05:00:00
## 8: 2013-04-02 23:00:00
```
]

  ] 

.panel[.panel-name[]


```r
flights_dt[month &lt;= 4 &amp; month &gt;= 3,]
```

```
##    year month day dep_time sched_dep_time dep_delay
## 1: 2013     3   1        4           2159       125
## 2: 2013     3   2       43           2355        48
## 3: 2013     4   1      454            500        -6
## 4: 2013     4   2        9           2355        14
##    arr_time sched_arr_time arr_delay carrier flight
## 1:      318             56       142      B6     11
## 2:      605            440        85      B6    739
## 3:      636            640        -4      US   1843
## 4:      346            345         1      B6    739
##    tailnum origin dest air_time distance hour minute
## 1:  N706JB    JFK  FLL      166     1069   21     59
## 2:  N623JB    JFK  PSE      219     1617   23     55
## 3:  N566UW    EWR  CLT       84      529    5      0
## 4:  N519JB    JFK  PSE      197     1617   23     55
##              time_hour
## 1: 2013-03-01 21:00:00
## 2: 2013-03-02 23:00:00
## 3: 2013-04-01 05:00:00
## 4: 2013-04-02 23:00:00
```

  ] 

  &lt;!-- panel ends here --&gt;
  &lt;!-- panel ends here --&gt;
 
]
 
 &lt;!-- panel set ends here --&gt;
  
 
---
  



    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
